#!/usr/bin/env bash

declare -A musiclist

musiclist["monstercat"]="https://www.twitch.tv/monstercat"
musiclist["monstercat-silk-deep"]="https://www.youtube.com/watch?v=WsDyRAPFBC8"
musiclist["monstercat-silk-adventure"]="https://www.youtube.com/watch?v=d8Oc90QevaI"
musiclist["monstercat-silk-chillout"]="https://www.youtube.com/watch?v=ql4S8z1jW8I"
musiclist["futurehouseradio-deephouse"]="https://www.youtube.com/watch?v=GDQnA1LVCWA"
musiclist["spinnin"]="https://www.youtube.com/watch?v=N65Jb683pXQ"
musiclist["lofigirl-focus"]="https://www.youtube.com/watch?v=5qap5aO4i9A"
musiclist["lofigirl-chill"]="https://www.youtube.com/watch?v=DWcJFNfaw9c"
musiclist["lofi-joma"]="https://www.youtube.com/watch?v=PY8f1Z3nARo"
musiclist["leekbeats"]="https://www.twitch.tv/leekbeats"
musiclist["thegabeconcept-proghouse"]="https://www.twitch.tv/thegabeconcept"

if [ -n "$1" ]; then
	if [[ "$1" == "help" ]]; then
		for key in "${!musiclist[@]}"; do
			echo "$key"
		done
		exit 0
	fi

	if [ -n "${musiclist[$1]}" ]; then
		MUSIC_PLAY_LINK="${musiclist[$1]}"
	else
		echo "Invalid live! Type 'help' to get the list!"
		exit 1
	fi
else
	MUSIC_PLAY_LINK="$(shuf -i 1-${#musiclist[@]} -n 1)"
fi

PLAYER_EXTRA_ARGS=()

if ! [[ -n "$2" && "$2" == "video" ]]; then
	PLAYER_EXTRA_ARGS+=("--no-video")
fi

mpv \
	"${PLAYER_EXTRA_ARGS[@]}" \
	--cache=yes \
	--cache-pause-initial=yes \
	--cache-pause-wait=10 \
	--stream-buffer-size=1048576 \
	--ytdl-raw-options=cache-dir=/dev/null \
	--ytdl-format="bestvideo[height<=?720]+bestaudio/best" \
	"$MUSIC_PLAY_LINK"
